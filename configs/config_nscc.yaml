# Configuration for NSCC TRAINING (GPU, full scale)
# This config is designed for training on NSCC Aspire 2A with A100 GPU

experiment_name: "denial_prompting_rl_mvp"
mode: "train"  # test or train

# Model Configuration (PRODUCTION SIZE)
model:
  name: "Salesforce/codegen-1B-mono"  # 1B parameter code generation model
  max_length: 512
  device: "cuda"
  load_in_8bit: false  # Set to true if memory constrained
  torch_dtype: "float16"  # Use mixed precision for speed

# Dataset Configuration
data:
  source: "neocoder"
  dataset_path: "data/raw/neocoder"
  num_problems: 199  # Full NeoCoder dataset
  train_split: 0.8
  val_split: 0.1
  test_split: 0.1
  seed: 42

# Denial Prompting Configuration
denial_prompting:
  use_curriculum: true
  curriculum_schedule:
    - stage: 1
      steps: [0, 1000]
      num_constraints: 0
      description: "Baseline - no denial"
    - stage: 2
      steps: [1001, 2500]
      num_constraints: 1
      description: "Easy denial - 1 constraint"
    - stage: 3
      steps: [2501, 4000]
      num_constraints: 2
      description: "Medium denial - 2 constraints"
    - stage: 4
      steps: [4001, 5000]
      num_constraints: 3
      description: "Hard denial - 3 constraints"
  max_constraints: 5

# GRPO Configuration
training:
  algorithm: "grpo"
  num_training_steps: 5000  # Full MVP training
  batch_size: 8
  group_size: 8  # GRPO: number of solutions per problem
  learning_rate: 1.0e-5
  warmup_steps: 100
  gradient_accumulation_steps: 4
  save_every: 500
  eval_every: 500
  log_every: 50
  max_grad_norm: 1.0
  seed: 42

# Reward Function Configuration (Simplified)
reward:
  # Reward = Correctness - (num_violations Ã— denial_penalty_weight)
  correctness_weight: 1.0           # Weight for passing test cases
  denial_penalty_weight: 0.5        # Penalty per denied technique violation

  # Execution settings
  timeout: 10  # seconds for code execution
  max_memory: 512  # MB

# Generation Configuration
generation:
  max_new_tokens: 512
  temperature: 0.8
  top_p: 0.95
  do_sample: true
  num_return_sequences: 1

# Evaluation Configuration
evaluation:
  pass_at_k: [1, 5, 10]
  compute_neogauge: true
  num_eval_problems: 199  # Full test set

# Logging Configuration
logging:
  use_wandb: true  # Enable experiment tracking
  wandb_project: "denial-prompting-rl"
  wandb_entity: null  # Set to your wandb username
  use_tensorboard: true
  log_dir: "logs"
  save_dir: "experiments"
  verbose: true

# Hardware Configuration
hardware:
  device: "cuda"
  num_workers: 8
  pin_memory: true
  mixed_precision: true
